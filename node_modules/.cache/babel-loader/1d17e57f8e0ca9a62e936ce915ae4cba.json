{"ast":null,"code":"import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{RelationshipStatusInfoEvent,RoomSessionFavoriteGroupUpdateEvent,RoomSessionUserBadgesEvent,RoomSessionUserFigureUpdateEvent,UserRelationshipsComposer}from'@nitrots/nitro-renderer';import{useEffect,useState}from'react';import{AvatarInfoUser,CloneObject,GetConfiguration,GetGroupInformation,GetSessionDataManager,GetUserProfile,LocalizeText,SendMessageComposer}from'../../../../../api';import{Column,Flex,LayoutAvatarImageView,LayoutBadgeImageView,Text,UserProfileIconView}from'../../../../../common';import{useMessageEvent,useRoom,useRoomSessionManagerEvent}from'../../../../../hooks';import{InfoStandWidgetUserRelationshipsView}from'./InfoStandWidgetUserRelationshipsView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const InfoStandWidgetUserView=props=>{const{avatarInfo=null,setAvatarInfo=null,onClose=null}=props;const[motto,setMotto]=useState(null);const[isEditingMotto,setIsEditingMotto]=useState(false);const[relationships,setRelationships]=useState(null);const{roomSession=null}=useRoom();const saveMotto=motto=>{if(!isEditingMotto||motto.length>GetConfiguration('motto.max.length',38))return;roomSession.sendMottoMessage(motto);setIsEditingMotto(false);};const onMottoBlur=event=>saveMotto(event.target.value);const onMottoKeyDown=event=>{event.stopPropagation();switch(event.key){case'Enter':saveMotto(event.target.value);return;}};useRoomSessionManagerEvent(RoomSessionUserBadgesEvent.RSUBE_BADGES,event=>{if(!avatarInfo||avatarInfo.webID!==event.userId)return;const oldBadges=avatarInfo.badges.join('');if(oldBadges===event.badges.join(''))return;setAvatarInfo(prevValue=>{const newValue=CloneObject(prevValue);newValue.badges=event.badges;return newValue;});});useRoomSessionManagerEvent(RoomSessionUserFigureUpdateEvent.USER_FIGURE,event=>{if(!avatarInfo||avatarInfo.roomIndex!==event.roomIndex)return;setAvatarInfo(prevValue=>{const newValue=CloneObject(prevValue);newValue.figure=event.figure;newValue.motto=event.customInfo;newValue.achievementScore=event.activityPoints;return newValue;});});useRoomSessionManagerEvent(RoomSessionFavoriteGroupUpdateEvent.FAVOURITE_GROUP_UPDATE,event=>{if(!avatarInfo||avatarInfo.roomIndex!==event.roomIndex)return;setAvatarInfo(prevValue=>{const newValue=CloneObject(prevValue);const clearGroup=event.status===-1||event.habboGroupId<=0;newValue.groupId=clearGroup?-1:event.habboGroupId;newValue.groupName=clearGroup?null:event.habboGroupName;newValue.groupBadgeId=clearGroup?null:GetSessionDataManager().getGroupBadge(event.habboGroupId);return newValue;});});useMessageEvent(RelationshipStatusInfoEvent,event=>{const parser=event.getParser();if(!avatarInfo||avatarInfo.webID!==parser.userId)return;setRelationships(parser);});useEffect(()=>{setIsEditingMotto(false);setMotto(avatarInfo.motto);SendMessageComposer(new UserRelationshipsComposer(avatarInfo.webID));return()=>{setIsEditingMotto(false);setMotto(null);setRelationships(null);};},[avatarInfo]);if(!avatarInfo)return null;return/*#__PURE__*/_jsx(Column,{className:\"nitro-infostand rounded\",children:/*#__PURE__*/_jsxs(Column,{overflow:\"visible\",className:\"container-fluid content-area\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(UserProfileIconView,{userId:avatarInfo.webID}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:avatarInfo.name})]}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\",className:\"cursor-pointer\",onClick:onClose})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Column,{fullWidth:true,className:\"body-image\",onClick:event=>GetUserProfile(avatarInfo.webID),children:/*#__PURE__*/_jsx(LayoutAvatarImageView,{figure:avatarInfo.figure,direction:4})}),/*#__PURE__*/_jsxs(Column,{grow:true,alignItems:\"center\",gap:0,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Flex,{center:true,className:\"badge-image\",children:avatarInfo.badges[0]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.badges[0],showInfo:true})}),/*#__PURE__*/_jsx(Flex,{center:true,pointer:avatarInfo.groupId>0,className:\"badge-image\",onClick:event=>GetGroupInformation(avatarInfo.groupId),children:avatarInfo.groupId>0&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.groupBadgeId,isGroup:true,showInfo:true,customTitle:avatarInfo.groupName})})]}),/*#__PURE__*/_jsxs(Flex,{center:true,gap:1,children:[/*#__PURE__*/_jsx(Flex,{center:true,className:\"badge-image\",children:avatarInfo.badges[1]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.badges[1],showInfo:true})}),/*#__PURE__*/_jsx(Flex,{center:true,className:\"badge-image\",children:avatarInfo.badges[2]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.badges[2],showInfo:true})})]}),/*#__PURE__*/_jsxs(Flex,{center:true,gap:1,children:[/*#__PURE__*/_jsx(Flex,{center:true,className:\"badge-image\",children:avatarInfo.badges[3]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.badges[3],showInfo:true})}),/*#__PURE__*/_jsx(Flex,{center:true,className:\"badge-image\",children:avatarInfo.badges[4]&&/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:avatarInfo.badges[4],showInfo:true})})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",className:\"bg-light-dark rounded py-1 px-2\",children:[avatarInfo.type!==AvatarInfoUser.OWN_USER&&/*#__PURE__*/_jsx(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:/*#__PURE__*/_jsx(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,small:true,variant:\"white\",children:motto})}),avatarInfo.type===AvatarInfoUser.OWN_USER&&/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"pencil-alt\",className:\"small\"}),/*#__PURE__*/_jsxs(Flex,{grow:true,alignItems:\"center\",className:\"motto-content\",children:[!isEditingMotto&&/*#__PURE__*/_jsxs(Text,{fullWidth:true,pointer:true,wrap:true,textBreak:true,small:true,variant:\"white\",onClick:event=>setIsEditingMotto(true),children:[motto,\"\\xA0\"]}),isEditingMotto&&/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"motto-input\",maxLength:GetConfiguration('motto.max.length',38),value:motto,onChange:event=>setMotto(event.target.value),onBlur:onMottoBlur,onKeyDown:onMottoKeyDown,autoFocus:true})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.achievement_score')+' '+avatarInfo.achievementScore}),avatarInfo.carryItem>0&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.handitem',['item'],[LocalizeText('handitem'+avatarInfo.carryItem)])})]})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsx(InfoStandWidgetUserRelationshipsView,{relationships:relationships})})]})});};","map":null,"metadata":{},"sourceType":"module"}