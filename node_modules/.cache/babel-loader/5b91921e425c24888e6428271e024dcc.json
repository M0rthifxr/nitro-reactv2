{"ast":null,"code":"import{RoomObjectType}from'@nitrots/nitro-renderer';import{useMemo,useState}from'react';import{ChatEntryType,LocalizeText,ReportState,ReportType}from'../../../api';import{AutoGrid,Button,Column,Flex,LayoutGridItem,Text}from'../../../common';import{useChatHistory,useHelp}from'../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const SelectReportedChatsView=props=>{const[selectedChats,setSelectedChats]=useState([]);const{activeReport=null,setActiveReport=null}=useHelp();const{chatHistory=[],messengerHistory=[]}=useChatHistory();const userChats=useMemo(()=>{switch(activeReport.reportType){case ReportType.BULLY:case ReportType.EMERGENCY:return chatHistory.filter(chat=>chat.type===ChatEntryType.TYPE_CHAT&&chat.entityId===activeReport.reportedUserId&&chat.entityType===RoomObjectType.USER);case ReportType.IM:return messengerHistory.filter(chat=>chat.entityId===activeReport.reportedUserId&&chat.type===ChatEntryType.TYPE_IM);}return[];},[activeReport,chatHistory,messengerHistory]);const selectChat=chatEntry=>{setSelectedChats(prevValue=>{const newValue=[...prevValue];const index=newValue.indexOf(chatEntry);if(index>=0)newValue.splice(index,1);else newValue.push(chatEntry);return newValue;});};const submitChats=()=>{if(!selectedChats||selectedChats.length<=0)return;setActiveReport(prevValue=>{return{...prevValue,reportedChats:selectedChats,currentStep:ReportState.SELECT_TOPICS};});};const back=()=>{setActiveReport(prevValue=>{return{...prevValue,currentStep:prevValue.currentStep-1};});};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{fontSize:4,children:LocalizeText('help.emergency.chat_report.subtitle')}),/*#__PURE__*/_jsx(Text,{children:LocalizeText('help.emergency.chat_report.description')})]}),/*#__PURE__*/_jsxs(Column,{gap:1,overflow:\"hidden\",children:[!userChats||!userChats.length&&/*#__PURE__*/_jsx(Text,{children:LocalizeText('help.cfh.error.no_user_data')}),userChats.length>0&&/*#__PURE__*/_jsx(AutoGrid,{gap:1,columnCount:1,columnMinHeight:25,overflow:\"auto\",children:userChats.map((chat,index)=>{return/*#__PURE__*/_jsx(LayoutGridItem,{onClick:event=>selectChat(chat),itemActive:selectedChats.indexOf(chat)>=0,children:/*#__PURE__*/_jsx(Text,{children:chat.message})},chat.id);})})]}),/*#__PURE__*/_jsxs(Flex,{gap:2,justifyContent:\"between\",children:[/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:back,disabled:activeReport.reportType===ReportType.IM,children:LocalizeText('generic.back')}),/*#__PURE__*/_jsx(Button,{disabled:selectedChats.length<=0,onClick:submitChats,children:LocalizeText('help.emergency.main.submit.button')})]})]});};","map":null,"metadata":{},"sourceType":"module"}