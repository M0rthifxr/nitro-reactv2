{"ast":null,"code":"import{RoomEngineEvent,RoomId,RoomObjectCategory,RoomObjectType}from'@nitrots/nitro-renderer';import{useEffect,useRef,useState}from'react';import{AddEventLinkTracker,CreateLinkEvent,GetRoomSession,RemoveLinkEventTracker}from'../../api';import{Base,Button,DraggableWindowPosition,NitroCardContentView,NitroCardHeaderView,NitroCardView}from'../../common';import{useModTools,useObjectSelectedEvent,useRoomEngineEvent}from'../../hooks';import{ModToolsChatlogView}from'./views/room/ModToolsChatlogView';import{ModToolsRoomView}from'./views/room/ModToolsRoomView';import{ModToolsTicketsView}from'./views/tickets/ModToolsTicketsView';import{ModToolsUserChatlogView}from'./views/user/ModToolsUserChatlogView';import{ModToolsUserView}from'./views/user/ModToolsUserView';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const ModToolsView=props=>{const[isVisible,setIsVisible]=useState(false);const[currentRoomId,setCurrentRoomId]=useState(-1);const[selectedUser,setSelectedUser]=useState(null);const[isTicketsVisible,setIsTicketsVisible]=useState(false);const{openRooms=[],openRoomChatlogs=[],openUserChatlogs=[],openUserInfos=[],openRoomInfo=null,closeRoomInfo=null,toggleRoomInfo=null,openRoomChatlog=null,closeRoomChatlog=null,toggleRoomChatlog=null,openUserInfo=null,closeUserInfo=null,toggleUserInfo=null,openUserChatlog=null,closeUserChatlog=null,toggleUserChatlog=null}=useModTools();const elementRef=useRef(null);useRoomEngineEvent([RoomEngineEvent.INITIALIZED,RoomEngineEvent.DISPOSED],event=>{if(RoomId.isRoomPreviewerId(event.roomId))return;switch(event.type){case RoomEngineEvent.INITIALIZED:setCurrentRoomId(event.roomId);return;case RoomEngineEvent.DISPOSED:setCurrentRoomId(-1);return;}});useObjectSelectedEvent(event=>{if(event.category!==RoomObjectCategory.UNIT)return;const roomSession=GetRoomSession();if(!roomSession)return;const userData=roomSession.userDataManager.getUserDataByIndex(event.id);if(!userData||userData.type!==RoomObjectType.USER)return;setSelectedUser({userId:userData.webID,username:userData.name});});useEffect(()=>{const linkTracker={linkReceived:url=>{const parts=url.split('/');if(parts.length<2)return;switch(parts[1]){case'show':setIsVisible(true);return;case'hide':setIsVisible(false);return;case'toggle':setIsVisible(prevValue=>!prevValue);return;case'open-room-info':openRoomInfo(Number(parts[2]));return;case'close-room-info':closeRoomInfo(Number(parts[2]));return;case'toggle-room-info':toggleRoomInfo(Number(parts[2]));return;case'open-room-chatlog':openRoomChatlog(Number(parts[2]));return;case'close-room-chatlog':closeRoomChatlog(Number(parts[2]));return;case'toggle-room-chatlog':toggleRoomChatlog(Number(parts[2]));return;case'open-user-info':openUserInfo(Number(parts[2]));return;case'close-user-info':closeUserInfo(Number(parts[2]));return;case'toggle-user-info':toggleUserInfo(Number(parts[2]));return;case'open-user-chatlog':openUserChatlog(Number(parts[2]));return;case'close-user-chatlog':closeUserChatlog(Number(parts[2]));return;case'toggle-user-chatlog':toggleUserChatlog(Number(parts[2]));return;}},eventUrlPrefix:'mod-tools/'};AddEventLinkTracker(linkTracker);return()=>RemoveLinkEventTracker(linkTracker);},[openRoomInfo,closeRoomInfo,toggleRoomInfo,openRoomChatlog,closeRoomChatlog,toggleRoomChatlog,openUserInfo,closeUserInfo,toggleUserInfo,openUserChatlog,closeUserChatlog,toggleUserChatlog]);return/*#__PURE__*/_jsxs(_Fragment,{children:[isVisible&&/*#__PURE__*/_jsxs(NitroCardView,{uniqueKey:\"mod-tools\",className:\"nitro-mod-tools\",windowPosition:DraggableWindowPosition.TOP_LEFT,theme:\"primary-slim\",children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'Mod Tools',onCloseClick:event=>setIsVisible(false)}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",gap:1,children:[/*#__PURE__*/_jsxs(Button,{gap:1,onClick:event=>CreateLinkEvent(`mod-tools/toggle-room-info/${currentRoomId}`),disabled:currentRoomId<=0,className:\"position-relative\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-small-room position-absolute start-1\"}),\" Room Tool\"]}),/*#__PURE__*/_jsxs(Button,{innerRef:elementRef,gap:1,onClick:event=>CreateLinkEvent(`mod-tools/toggle-room-chatlog/${currentRoomId}`),disabled:currentRoomId<=0,className:\"position-relative\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-chat-history position-absolute start-1\"}),\" Chatlog Tool\"]}),/*#__PURE__*/_jsxs(Button,{gap:1,onClick:()=>CreateLinkEvent(`mod-tools/toggle-user-info/${selectedUser.userId}`),disabled:!selectedUser,className:\"position-relative\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-user position-absolute start-1\"}),\" User: \",selectedUser?selectedUser.username:'']}),/*#__PURE__*/_jsxs(Button,{gap:1,onClick:()=>setIsTicketsVisible(prevValue=>!prevValue),className:\"position-relative\",children:[/*#__PURE__*/_jsx(Base,{className:\"icon icon-tickets position-absolute start-1\"}),\" Report Tool\"]})]})]}),openRooms.length>0&&openRooms.map(roomId=>/*#__PURE__*/_jsx(ModToolsRoomView,{roomId:roomId,onCloseClick:()=>CreateLinkEvent(`mod-tools/close-room-info/${roomId}`)},roomId)),openRoomChatlogs.length>0&&openRoomChatlogs.map(roomId=>/*#__PURE__*/_jsx(ModToolsChatlogView,{roomId:roomId,onCloseClick:()=>CreateLinkEvent(`mod-tools/close-room-chatlog/${roomId}`)},roomId)),openUserInfos.length>0&&openUserInfos.map(userId=>/*#__PURE__*/_jsx(ModToolsUserView,{userId:userId,onCloseClick:()=>CreateLinkEvent(`mod-tools/close-user-info/${userId}`)},userId)),openUserChatlogs.length>0&&openUserChatlogs.map(userId=>/*#__PURE__*/_jsx(ModToolsUserChatlogView,{userId:userId,onCloseClick:()=>CreateLinkEvent(`mod-tools/close-user-chatlog/${userId}`)},userId)),isTicketsVisible&&/*#__PURE__*/_jsx(ModToolsTicketsView,{onCloseClick:()=>setIsTicketsVisible(false)})]});};","map":null,"metadata":{},"sourceType":"module"}