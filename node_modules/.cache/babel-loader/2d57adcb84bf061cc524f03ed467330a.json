{"ast":null,"code":"import{GetModeratorRoomInfoMessageComposer,ModerateRoomMessageComposer,ModeratorActionMessageComposer,ModeratorRoomInfoEvent}from'@nitrots/nitro-renderer';import{useEffect,useState}from'react';import{CreateLinkEvent,SendMessageComposer,TryVisitRoom}from'../../../../api';import{Button,Column,DraggableWindowPosition,Flex,NitroCardContentView,NitroCardHeaderView,NitroCardView,Text}from'../../../../common';import{useMessageEvent}from'../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const ModToolsRoomView=props=>{const{roomId=null,onCloseClick=null}=props;const[infoRequested,setInfoRequested]=useState(false);const[loadedRoomId,setLoadedRoomId]=useState(null);const[name,setName]=useState(null);const[ownerId,setOwnerId]=useState(null);const[ownerName,setOwnerName]=useState(null);const[ownerInRoom,setOwnerInRoom]=useState(false);const[usersInRoom,setUsersInRoom]=useState(0);const[kickUsers,setKickUsers]=useState(false);const[lockRoom,setLockRoom]=useState(false);const[changeRoomName,setChangeRoomName]=useState(false);const[message,setMessage]=useState('');const handleClick=(action,value)=>{if(!action)return;switch(action){case'alert_only':if(message.trim().length===0)return;SendMessageComposer(new ModeratorActionMessageComposer(ModeratorActionMessageComposer.ACTION_ALERT,message,''));SendMessageComposer(new ModerateRoomMessageComposer(roomId,lockRoom?1:0,changeRoomName?1:0,kickUsers?1:0));return;case'send_message':if(message.trim().length===0)return;SendMessageComposer(new ModeratorActionMessageComposer(ModeratorActionMessageComposer.ACTION_MESSAGE,message,''));SendMessageComposer(new ModerateRoomMessageComposer(roomId,lockRoom?1:0,changeRoomName?1:0,kickUsers?1:0));return;}};useMessageEvent(ModeratorRoomInfoEvent,event=>{const parser=event.getParser();if(!parser||parser.data.flatId!==roomId)return;setLoadedRoomId(parser.data.flatId);setName(parser.data.room.name);setOwnerId(parser.data.ownerId);setOwnerName(parser.data.ownerName);setOwnerInRoom(parser.data.ownerInRoom);setUsersInRoom(parser.data.userCount);});useEffect(()=>{if(infoRequested)return;SendMessageComposer(new GetModeratorRoomInfoMessageComposer(roomId));setInfoRequested(true);},[roomId,infoRequested,setInfoRequested]);return/*#__PURE__*/_jsxs(NitroCardView,{className:\"nitro-mod-tools-room\",theme:\"primary-slim\",windowPosition:DraggableWindowPosition.TOP_LEFT,children:[/*#__PURE__*/_jsx(NitroCardHeaderView,{headerText:'Room Info'+(name?': '+name:''),onCloseClick:event=>onCloseClick()}),/*#__PURE__*/_jsxs(NitroCardContentView,{className:\"text-black\",children:[/*#__PURE__*/_jsxs(Flex,{gap:2,children:[/*#__PURE__*/_jsxs(Column,{justifyContent:\"center\",grow:true,gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(Text,{bold:true,align:\"end\",className:\"col-7\",children:\"Room Owner:\"}),/*#__PURE__*/_jsx(Text,{underline:true,pointer:true,truncate:true,children:ownerName})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(Text,{bold:true,align:\"end\",className:\"col-7\",children:\"Users in room:\"}),/*#__PURE__*/_jsx(Text,{children:usersInRoom})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:2,children:[/*#__PURE__*/_jsx(Text,{bold:true,align:\"end\",className:\"col-7\",children:\"Owner in room:\"}),/*#__PURE__*/_jsx(Text,{children:ownerInRoom?'Yes':'No'})]})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Button,{onClick:event=>TryVisitRoom(roomId),children:\"Visit Room\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>CreateLinkEvent(`mod-tools/open-room-chatlog/${roomId}`),children:\"Chatlog\"})]})]}),/*#__PURE__*/_jsxs(Column,{className:\"bg-muted rounded p-2\",gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:kickUsers,onChange:event=>setKickUsers(event.target.checked)}),/*#__PURE__*/_jsx(Text,{small:true,children:\"Kick everyone out\"})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:lockRoom,onChange:event=>setLockRoom(event.target.checked)}),/*#__PURE__*/_jsx(Text,{small:true,children:\"Enable the doorbell\"})]}),/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(\"input\",{className:\"form-check-input\",type:\"checkbox\",checked:changeRoomName,onChange:event=>setChangeRoomName(event.target.checked)}),/*#__PURE__*/_jsx(Text,{small:true,children:\"Change room name\"})]})]}),/*#__PURE__*/_jsx(\"textarea\",{className:\"form-control\",placeholder:\"Type a mandatory message to the users in this text box...\",value:message,onChange:event=>setMessage(event.target.value)}),/*#__PURE__*/_jsxs(Flex,{justifyContent:\"between\",children:[/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:event=>handleClick('send_message'),children:\"Send Caution\"}),/*#__PURE__*/_jsx(Button,{onClick:event=>handleClick('alert_only'),children:\"Send Alert only\"})]})]})]});};","map":null,"metadata":{},"sourceType":"module"}