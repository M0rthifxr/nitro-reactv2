{"ast":null,"code":"import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{PetRespectComposer,PetType}from'@nitrots/nitro-renderer';import{useEffect,useState}from'react';import{ConvertSeconds,CreateLinkEvent,GetConfiguration,LocalizeText,SendMessageComposer}from'../../../../../api';import{Base,Button,Column,Flex,LayoutCounterTimeView,LayoutPetImageView,LayoutRarityLevelView,Text,UserProfileIconView}from'../../../../../common';import{useRoom,useSessionInfo}from'../../../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const InfoStandWidgetPetView=props=>{const{avatarInfo=null,onClose=null}=props;const[remainingGrowTime,setRemainingGrowTime]=useState(0);const[remainingTimeToLive,setRemainingTimeToLive]=useState(0);const{roomSession=null}=useRoom();const{petRespectRemaining=0,respectPet=null}=useSessionInfo();useEffect(()=>{setRemainingGrowTime(avatarInfo.remainingGrowTime);setRemainingTimeToLive(avatarInfo.remainingTimeToLive);},[avatarInfo]);useEffect(()=>{if(avatarInfo.petType!==PetType.MONSTERPLANT||avatarInfo.dead)return;const interval=setInterval(()=>{setRemainingGrowTime(prevValue=>prevValue-1);setRemainingTimeToLive(prevValue=>prevValue-1);},1000);return()=>clearInterval(interval);},[avatarInfo]);if(!avatarInfo)return null;const processButtonAction=action=>{let hideMenu=true;if(!action||action=='')return;switch(action){case'respect':respectPet(avatarInfo.id);if(petRespectRemaining-1>=1)hideMenu=false;break;case'buyfood':CreateLinkEvent('catalog/open/'+GetConfiguration('catalog.links')['pets.buy_saddle']);break;case'train':// not coded\nbreak;case'treat':SendMessageComposer(new PetRespectComposer(avatarInfo.id));break;case'compost':roomSession===null||roomSession===void 0?void 0:roomSession.compostPlant(avatarInfo.id);break;case'pick_up':roomSession===null||roomSession===void 0?void 0:roomSession.pickupPet(avatarInfo.id);break;}if(hideMenu)onClose();};return/*#__PURE__*/_jsxs(Column,{gap:1,alignItems:\"end\",children:[/*#__PURE__*/_jsx(Column,{className:\"nitro-infostand rounded\",children:/*#__PURE__*/_jsxs(Column,{overflow:\"visible\",className:\"container-fluid content-area\",gap:1,children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:avatarInfo.name}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:\"times\",className:\"cursor-pointer\",onClick:onClose})]}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText(`pet.breed.${avatarInfo.petType}.${avatarInfo.petBreed}`)}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),avatarInfo.petType===PetType.MONSTERPLANT&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Column,{center:true,gap:1,children:[/*#__PURE__*/_jsx(LayoutPetImageView,{figure:avatarInfo.petFigure,posture:avatarInfo.posture,direction:4}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:2,children:[!avatarInfo.dead&&/*#__PURE__*/_jsx(Column,{alignItems:\"center\",gap:1,children:/*#__PURE__*/_jsx(Text,{variant:\"white\",center:true,small:true,wrap:true,children:LocalizeText('pet.level',['level','maxlevel'],[avatarInfo.level.toString(),avatarInfo.maximumLevel.toString()])})}),/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.wellbeing')}),/*#__PURE__*/_jsxs(Base,{fullWidth:true,overflow:\"hidden\",position:\"relative\",className:\"bg-light-dark rounded\",children:[/*#__PURE__*/_jsx(Flex,{fit:true,center:true,position:\"absolute\",children:/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,children:avatarInfo.dead?'00:00:00':ConvertSeconds(remainingTimeToLive==0?avatarInfo.remainingTimeToLive:remainingTimeToLive).split(':')[1]+':'+ConvertSeconds(remainingTimeToLive==null||remainingTimeToLive==undefined?0:remainingTimeToLive).split(':')[2]+':'+ConvertSeconds(remainingTimeToLive==null||remainingTimeToLive==undefined?0:remainingTimeToLive).split(':')[3]})}),/*#__PURE__*/_jsx(Base,{className:\"bg-success rounded pet-stats\",style:{width:avatarInfo.dead?'0':Math.round(avatarInfo.maximumTimeToLive*100/remainingTimeToLive).toString()}})]})]}),remainingGrowTime!=0&&remainingGrowTime>0&&/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.growth')}),/*#__PURE__*/_jsx(LayoutCounterTimeView,{className:\"top-2 end-2\",day:ConvertSeconds(remainingGrowTime).split(':')[0],hour:ConvertSeconds(remainingGrowTime).split(':')[1],minutes:ConvertSeconds(remainingGrowTime).split(':')[2],seconds:ConvertSeconds(remainingGrowTime).split(':')[3]})]}),/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.raritylevel',['level'],[LocalizeText(`infostand.pet.raritylevel.${avatarInfo.rarityLevel}`)])}),/*#__PURE__*/_jsx(LayoutRarityLevelView,{className:\"top-2 end-2\",level:avatarInfo.rarityLevel})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('pet.age',['age'],[avatarInfo.age.toString()])}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]})]}),avatarInfo.petType!==PetType.MONSTERPLANT&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Column,{gap:1,children:[/*#__PURE__*/_jsxs(Flex,{gap:1,children:[/*#__PURE__*/_jsx(Column,{fullWidth:true,overflow:\"hidden\",className:\"body-image pet p-1\",children:/*#__PURE__*/_jsx(LayoutPetImageView,{figure:avatarInfo.petFigure,posture:avatarInfo.posture,direction:4})}),/*#__PURE__*/_jsxs(Column,{grow:true,gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",center:true,small:true,wrap:true,children:LocalizeText('pet.level',['level','maxlevel'],[avatarInfo.level.toString(),avatarInfo.maximumLevel.toString()])}),/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.happiness')}),/*#__PURE__*/_jsxs(Base,{fullWidth:true,overflow:\"hidden\",position:\"relative\",className:\"bg-light-dark rounded\",children:[/*#__PURE__*/_jsx(Flex,{fit:true,center:true,position:\"absolute\",children:/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,children:avatarInfo.happyness+'/'+avatarInfo.maximumHappyness})}),/*#__PURE__*/_jsx(Base,{className:\"bg-info rounded pet-stats\",style:{width:avatarInfo.happyness/avatarInfo.maximumHappyness*100+'%'}})]})]}),/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.experience')}),/*#__PURE__*/_jsxs(Base,{fullWidth:true,overflow:\"hidden\",position:\"relative\",className:\"bg-light-dark rounded\",children:[/*#__PURE__*/_jsx(Flex,{fit:true,center:true,position:\"absolute\",children:/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,children:avatarInfo.experience+'/'+avatarInfo.levelExperienceGoal})}),/*#__PURE__*/_jsx(Base,{className:\"bg-purple rounded pet-stats\",style:{width:avatarInfo.experience/avatarInfo.levelExperienceGoal*100+'%'}})]})]}),/*#__PURE__*/_jsxs(Column,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,truncate:true,children:LocalizeText('infostand.pet.text.energy')}),/*#__PURE__*/_jsxs(Base,{fullWidth:true,overflow:\"hidden\",position:\"relative\",className:\"bg-light-dark rounded\",children:[/*#__PURE__*/_jsx(Flex,{fit:true,center:true,position:\"absolute\",children:/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,children:avatarInfo.energy+'/'+avatarInfo.maximumEnergy})}),/*#__PURE__*/_jsx(Base,{className:\"bg-success rounded pet-stats\",style:{width:avatarInfo.energy/avatarInfo.maximumEnergy*100+'%'}})]})]})]})]}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]}),/*#__PURE__*/_jsxs(Column,{gap:1,children:[avatarInfo.petType!==PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.petrespect',['count'],[avatarInfo.respect.toString()])}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('pet.age',['age'],[avatarInfo.age.toString()])}),/*#__PURE__*/_jsx(\"hr\",{className:\"m-0\"})]})]}),/*#__PURE__*/_jsx(Column,{gap:1,children:/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",gap:1,children:[/*#__PURE__*/_jsx(UserProfileIconView,{userId:avatarInfo.ownerId}),/*#__PURE__*/_jsx(Text,{variant:\"white\",small:true,wrap:true,children:LocalizeText('infostand.text.petowner',['name'],[avatarInfo.ownerName])})]})})]})}),/*#__PURE__*/_jsxs(Flex,{gap:1,justifyContent:\"end\",children:[avatarInfo.petType!==PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('buyfood'),children:LocalizeText('infostand.button.buyfood')}),avatarInfo.isOwner&&avatarInfo.petType!==PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('train'),children:LocalizeText('infostand.button.train')}),!avatarInfo.dead&&avatarInfo.energy/avatarInfo.maximumEnergy<0.98&&avatarInfo.petType===PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('treat'),children:LocalizeText('infostand.button.pettreat')}),(roomSession===null||roomSession===void 0?void 0:roomSession.isRoomOwner)&&avatarInfo.petType===PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('compost'),children:LocalizeText('infostand.button.compost')}),avatarInfo.isOwner&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('pick_up'),children:LocalizeText('inventory.pets.pickup')}),petRespectRemaining>0&&avatarInfo.petType!==PetType.MONSTERPLANT&&/*#__PURE__*/_jsx(Button,{variant:\"dark\",onClick:event=>processButtonAction('respect'),children:LocalizeText('infostand.button.petrespect',['count'],[petRespectRemaining.toString()])})]})]});};","map":null,"metadata":{},"sourceType":"module"}