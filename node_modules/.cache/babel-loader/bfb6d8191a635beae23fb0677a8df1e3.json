{"ast":null,"code":"import{RoomEngineEvent,RoomEnterEffect,RoomSessionDanceEvent}from'@nitrots/nitro-renderer';import{useState}from'react';import{AvatarInfoFurni,AvatarInfoPet,AvatarInfoRentableBot,AvatarInfoUser,GetSessionDataManager,RoomWidgetUpdateRentableBotChatEvent}from'../../../../api';import{Column}from'../../../../common';import{useAvatarInfoWidget,useRoom,useRoomEngineEvent,useRoomSessionManagerEvent,useUiEvent}from'../../../../hooks';import{AvatarInfoRentableBotChatView}from'./AvatarInfoRentableBotChatView';import{AvatarInfoUseProductConfirmView}from'./AvatarInfoUseProductConfirmView';import{AvatarInfoUseProductView}from'./AvatarInfoUseProductView';import{InfoStandWidgetBotView}from'./infostand/InfoStandWidgetBotView';import{InfoStandWidgetFurniView}from'./infostand/InfoStandWidgetFurniView';import{InfoStandWidgetPetView}from'./infostand/InfoStandWidgetPetView';import{InfoStandWidgetRentableBotView}from'./infostand/InfoStandWidgetRentableBotView';import{InfoStandWidgetUserView}from'./infostand/InfoStandWidgetUserView';import{AvatarInfoWidgetAvatarView}from'./menu/AvatarInfoWidgetAvatarView';import{AvatarInfoWidgetDecorateView}from'./menu/AvatarInfoWidgetDecorateView';import{AvatarInfoWidgetFurniView}from'./menu/AvatarInfoWidgetFurniView';import{AvatarInfoWidgetNameView}from'./menu/AvatarInfoWidgetNameView';import{AvatarInfoWidgetOwnAvatarView}from'./menu/AvatarInfoWidgetOwnAvatarView';import{AvatarInfoWidgetOwnPetView}from'./menu/AvatarInfoWidgetOwnPetView';import{AvatarInfoWidgetPetView}from'./menu/AvatarInfoWidgetPetView';import{AvatarInfoWidgetRentableBotView}from'./menu/AvatarInfoWidgetRentableBotView';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export const AvatarInfoWidgetView=props=>{const[isGameMode,setGameMode]=useState(false);const[isDancing,setIsDancing]=useState(false);const[rentableBotChatEvent,setRentableBotChatEvent]=useState(null);const{avatarInfo=null,setAvatarInfo=null,activeNameBubble=null,setActiveNameBubble=null,nameBubbles=[],removeNameBubble=null,productBubbles=[],confirmingProduct=null,updateConfirmingProduct=null,removeProductBubble=null,isDecorating=false,setIsDecorating=null}=useAvatarInfoWidget();const{roomSession=null}=useRoom();useRoomEngineEvent(RoomEngineEvent.NORMAL_MODE,event=>{if(isGameMode)setGameMode(false);});useRoomEngineEvent(RoomEngineEvent.GAME_MODE,event=>{if(!isGameMode)setGameMode(true);});useRoomSessionManagerEvent(RoomSessionDanceEvent.RSDE_DANCE,event=>{if(event.roomIndex!==roomSession.ownRoomIndex)return;setIsDancing(event.danceId!==0);});useUiEvent(RoomWidgetUpdateRentableBotChatEvent.UPDATE_CHAT,event=>setRentableBotChatEvent(event));const getMenuView=()=>{if(!roomSession||isGameMode)return null;if(activeNameBubble)return/*#__PURE__*/_jsx(AvatarInfoWidgetNameView,{nameInfo:activeNameBubble,onClose:()=>setActiveNameBubble(null)});if(avatarInfo){switch(avatarInfo.type){case AvatarInfoFurni.FURNI:{const info=avatarInfo;if(!isDecorating)return null;return/*#__PURE__*/_jsx(AvatarInfoWidgetFurniView,{avatarInfo:info,onClose:()=>setAvatarInfo(null)});}case AvatarInfoUser.OWN_USER:case AvatarInfoUser.PEER:{const info=avatarInfo;if(info.isSpectatorMode)return null;if(info.isOwnUser){if(RoomEnterEffect.isRunning())return null;return/*#__PURE__*/_jsx(AvatarInfoWidgetOwnAvatarView,{avatarInfo:info,isDancing:isDancing,setIsDecorating:setIsDecorating,onClose:()=>setAvatarInfo(null)});}return/*#__PURE__*/_jsx(AvatarInfoWidgetAvatarView,{avatarInfo:info,onClose:()=>setAvatarInfo(null)});}case AvatarInfoPet.PET_INFO:{const info=avatarInfo;if(info.isOwner)return/*#__PURE__*/_jsx(AvatarInfoWidgetOwnPetView,{avatarInfo:info,onClose:()=>setAvatarInfo(null)});return/*#__PURE__*/_jsx(AvatarInfoWidgetPetView,{avatarInfo:info,onClose:()=>setAvatarInfo(null)});}case AvatarInfoRentableBot.RENTABLE_BOT:{return/*#__PURE__*/_jsx(AvatarInfoWidgetRentableBotView,{avatarInfo:avatarInfo,onClose:()=>setAvatarInfo(null)});}}}return null;};const getInfostandView=()=>{if(!avatarInfo)return null;switch(avatarInfo.type){case AvatarInfoFurni.FURNI:return/*#__PURE__*/_jsx(InfoStandWidgetFurniView,{avatarInfo:avatarInfo,onClose:()=>setAvatarInfo(null)});case AvatarInfoUser.OWN_USER:case AvatarInfoUser.PEER:return/*#__PURE__*/_jsx(InfoStandWidgetUserView,{avatarInfo:avatarInfo,setAvatarInfo:setAvatarInfo,onClose:()=>setAvatarInfo(null)});case AvatarInfoUser.BOT:return/*#__PURE__*/_jsx(InfoStandWidgetBotView,{avatarInfo:avatarInfo,onClose:()=>setAvatarInfo(null)});case AvatarInfoRentableBot.RENTABLE_BOT:return/*#__PURE__*/_jsx(InfoStandWidgetRentableBotView,{avatarInfo:avatarInfo,onClose:()=>setAvatarInfo(null)});case AvatarInfoPet.PET_INFO:return/*#__PURE__*/_jsx(InfoStandWidgetPetView,{avatarInfo:avatarInfo,onClose:()=>setAvatarInfo(null)});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[isDecorating&&/*#__PURE__*/_jsx(AvatarInfoWidgetDecorateView,{userId:GetSessionDataManager().userId,userName:GetSessionDataManager().userName,roomIndex:roomSession.ownRoomIndex,setIsDecorating:setIsDecorating}),getMenuView(),avatarInfo&&/*#__PURE__*/_jsx(Column,{alignItems:\"end\",className:\"nitro-infostand-container\",children:getInfostandView()}),nameBubbles.length>0&&nameBubbles.map((name,index)=>/*#__PURE__*/_jsx(AvatarInfoWidgetNameView,{nameInfo:name,onClose:()=>removeNameBubble(index)},index)),productBubbles.length>0&&productBubbles.map((item,index)=>{return/*#__PURE__*/_jsx(AvatarInfoUseProductView,{item:item,updateConfirmingProduct:updateConfirmingProduct,onClose:()=>removeProductBubble(index)},item.id);}),rentableBotChatEvent&&/*#__PURE__*/_jsx(AvatarInfoRentableBotChatView,{chatEvent:rentableBotChatEvent,onClose:()=>setRentableBotChatEvent(null)}),confirmingProduct&&/*#__PURE__*/_jsx(AvatarInfoUseProductConfirmView,{item:confirmingProduct,onClose:()=>updateConfirmingProduct(null)})]});};","map":null,"metadata":{},"sourceType":"module"}