{"ast":null,"code":"import{FontAwesomeIcon}from'@fortawesome/react-fontawesome';import{DesktopViewEvent,GetGuestRoomResultEvent,GroupInformationComposer,GroupInformationEvent,GroupRemoveMemberComposer,HabboGroupDeactivatedMessageEvent,RoomEntryInfoMessageEvent}from'@nitrots/nitro-renderer';import{useState}from'react';import{GetGroupInformation,GetGroupManager,GetSessionDataManager,GroupMembershipType,GroupType,LocalizeText,SendMessageComposer,TryJoinGroup}from'../../../api';import{Base,Button,Column,Flex,LayoutBadgeImageView,Text}from'../../../common';import{useMessageEvent,useNotification}from'../../../hooks';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export const GroupRoomInformationView=props=>{const[expectedGroupId,setExpectedGroupId]=useState(0);const[groupInformation,setGroupInformation]=useState(null);const[isOpen,setIsOpen]=useState(true);const{showConfirm=null}=useNotification();useMessageEvent(DesktopViewEvent,event=>{setExpectedGroupId(0);setGroupInformation(null);});useMessageEvent(RoomEntryInfoMessageEvent,event=>{setExpectedGroupId(0);setGroupInformation(null);});useMessageEvent(GetGuestRoomResultEvent,event=>{const parser=event.getParser();if(!parser.roomEnter)return;if(parser.data.habboGroupId>0){setExpectedGroupId(parser.data.habboGroupId);SendMessageComposer(new GroupInformationComposer(parser.data.habboGroupId,false));}else{setExpectedGroupId(0);setGroupInformation(null);}});useMessageEvent(HabboGroupDeactivatedMessageEvent,event=>{const parser=event.getParser();if(!groupInformation||parser.groupId!==groupInformation.id&&parser.groupId!==expectedGroupId)return;setExpectedGroupId(0);setGroupInformation(null);});useMessageEvent(GroupInformationEvent,event=>{const parser=event.getParser();if(parser.id!==expectedGroupId)return;setGroupInformation(parser);});const leaveGroup=()=>{showConfirm(LocalizeText('group.leaveconfirm.desc'),()=>{SendMessageComposer(new GroupRemoveMemberComposer(groupInformation.id,GetSessionDataManager().userId));},null);};const isRealOwner=groupInformation&&groupInformation.ownerName===GetSessionDataManager().userName;const getButtonText=()=>{if(isRealOwner)return'group.manage';if(groupInformation.type===GroupType.PRIVATE)return'';if(groupInformation.membershipType===GroupMembershipType.MEMBER)return'group.leave';if(groupInformation.membershipType===GroupMembershipType.NOT_MEMBER&&groupInformation.type===GroupType.REGULAR)return'group.join';if(groupInformation.membershipType===GroupMembershipType.REQUEST_PENDING)return'group.membershippending';if(groupInformation.membershipType===GroupMembershipType.NOT_MEMBER&&groupInformation.type===GroupType.EXCLUSIVE)return'group.requestmembership';};const handleButtonClick=()=>{if(isRealOwner)return GetGroupManager(groupInformation.id);if(groupInformation.type===GroupType.PRIVATE&&groupInformation.membershipType===GroupMembershipType.NOT_MEMBER)return;if(groupInformation.membershipType===GroupMembershipType.MEMBER){leaveGroup();return;}TryJoinGroup(groupInformation.id);};if(!groupInformation)return null;return/*#__PURE__*/_jsx(Base,{className:\"nitro-notification-bubble rounded\",children:/*#__PURE__*/_jsxs(Column,{children:[/*#__PURE__*/_jsxs(Flex,{alignItems:\"center\",justifyContent:\"between\",pointer:true,onClick:event=>setIsOpen(value=>!value),children:[/*#__PURE__*/_jsx(Text,{variant:\"white\",children:LocalizeText('group.homeroominfo.title')}),/*#__PURE__*/_jsx(FontAwesomeIcon,{icon:isOpen?'chevron-up':'chevron-down'})]}),isOpen&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Flex,{pointer:true,alignItems:\"center\",gap:2,onClick:event=>GetGroupInformation(groupInformation.id),children:[/*#__PURE__*/_jsx(Base,{className:\"group-badge\",children:/*#__PURE__*/_jsx(LayoutBadgeImageView,{badgeCode:groupInformation.badge,isGroup:true})}),/*#__PURE__*/_jsx(Text,{variant:\"white\",children:groupInformation.title})]}),(groupInformation.type!==GroupType.PRIVATE||isRealOwner)&&/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"success\",disabled:groupInformation.membershipType===GroupMembershipType.REQUEST_PENDING,onClick:handleButtonClick,children:LocalizeText(getButtonText())})]})]})});};","map":null,"metadata":{},"sourceType":"module"}